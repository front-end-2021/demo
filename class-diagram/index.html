<!DOCTYPE html>
<html>

<head>
  <title>Class Diagram</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  </link>
  <link rel="stylesheet" href="./m-style.css">
  </link>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/1c-light.min.css" 
    integrity="sha512-kM8PiTB2J9j9MJxP4pg5Morv1nvatwpY0xsNsHDpHobti6+sdvObgLPhJ7lOIHYUqQmTAUAE+CaTcQXR47XO2w==" 
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js" 
    integrity="sha512-EBLzUL8XLl+va/zAsmXwS7Z2B1F9HUHkZwyS/VKwh3S7T/U0nF4BaU29EP/ZSf6zgiIxYAnKLu6bJ8dqpmX5uw==" 
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script type="importmap">
    {
      "imports": {
        "vue": "https://unpkg.com/vue@3/dist/vue.esm-browser.js",
        "vue-draggable-next": "https://cdn.jsdelivr.net/npm/vue-draggable-next@2.2.1/+esm"
      }
    }
  </script>

</head>

<body style="margin: 8px;">
  <main id="m-app" v-cloak>
    <header class="">
      <section class="">

      </section>
      <nav class="">

      </nav>
      <section class="">

      </section>
    </header>

    <component :is="CompPage" v-cloak></component>

    <div v-if="ViewCode"
      style="min-width: 360px; min-height: 250px; box-sizing: border-box;
            position: fixed; left: calc(249px + 220px); top: calc(39px - 12px);
            border-radius: 10px; background-color: #cde5f9; padding: 18px;"
      :style="[{
      top: ViewCode.top + 'px', left: ViewCode.left + 'px'
     }]"
      id="dnb-viewcode">
      <pre><code class="language-csharp" v-html="ViewCode.html"></code></pre>
      <i style="width: 24px;height: 20px;display: inline-block;text-align: center;
        background-color: white;position: absolute;right: 5px;top: 5px;border-radius: 6px;padding-top: 4px;"
        class="bi bi-x-lg cpoint" @click.stop="e => { DynamicVar.delete('FViewCode')}"></i>
    </div>
    <div v-if="EditObject"
      class="mformedit">
        <div style="margin-bottom: 12px; display: flex;align-items: center;">
          
          <menu-list :value="getTxtType(EditObject.item.type)" :isfix="true"
            :sources="StructTypes.map(x => x[PLang])"
            @change:value="$e => changeTypeObject($e)">
          </menu-list>
          <span contenteditable="true"
            @input="e => onChange(e, 'class name')"
            @keypress="e => preventKeyPress(e, [13, 32])"
            data-placeholder="NameOfClass"
            class="p36 ceditable" v-html="EditObject.item.Name">
          </span>
          
        </div>
        <div v-for="(field, ii) in EditObject.iFields"
          :key="'oldfield_' + field.AcModify"
          style="margin-bottom: 2px; display: flex;align-items: center;">
          <span @keypress="e => preventKeyPress(e, [13])"
            @input="e => onChange(e, 'field acmodify', ii)"
            data-placeholder="AccessoriOfField"
            class="p36 ceditable" contenteditable="true">{{getTxtAcModify(field.AcModify)}}</span>
          <span @keypress="e => preventKeyPress(e, [13, 32])"
            @input="e => onChange(e, 'field name', ii)"
            data-placeholder="NameOfField"
            class="p36 ceditable" contenteditable="true" v-html="field.Name"></span>
          <span @keypress="e => preventKeyPress(e, [13])"
            @input="e => onChange(e, 'field type', ii)"
            data-placeholder="TypeOfField"
            class="p36 ceditable" contenteditable="true" v-html="field.Type"></span>
          <span style="margin-left: 12px;cursor: pointer;"
            @click.stop="e => removeField(ii)"><i class="bi bi-trash3"></i></span>
        </div>
        <div v-if="EditObject.Fields">
          <div v-for="(field, ii) in EditObject.Fields"
            :key="'newfield_' + field.ii"
            style="margin-bottom: 2px; display: flex;align-items: center;">
            <span @keypress="e => preventKeyPress(e, [13])"
              @blur="e => onEditNewField(e, 'field acmodify', ii)"
              data-placeholder="AccessoriOfNewField"
              class="p36 ceditable" contenteditable="true">{{field.AcModify}}</span>
            <span @keypress="e => preventKeyPress(e, [13, 32])"
              @blur="e => onEditNewField(e, 'field name', ii)"
              data-placeholder="NameOfNewField"
              class="p36 ceditable" contenteditable="true" v-html="field.Name"></span>
            <span @keypress="e => preventKeyPress(e, [13, 32])"
              @blur="e => onEditNewField(e, 'field type', ii)"
              data-placeholder="TypeOfNewField"
              class="p36 ceditable" contenteditable="true" v-html="field.Type"></span>
            <span style="margin-left: 12px;cursor: pointer;"
              @click.stop="e => removeField(ii, true)"><i class="bi bi-trash3"></i></span>
          </div>
        </div>
        <span style="cursor: pointer;"
            @click.stop="addField">[new Field]</span>
        <div v-for="(prp, ii) in EditObject.iPropes"
          style="margin-bottom: 2px;"
          :style="[0 == ii ? {marginTop: '10px'} : null]">
          <div style="display: flex;align-items: center;">
            <span class="p36 ceditable" @keypress="e => preventKeyPress(e, [13])"
              @input="e => onChange(e, 'access modify key', ii)"
              data-placeholder="AccessoriOfProperty"
              contenteditable="true">{{getTxtAcModify(prp[0])}}</span>
            
            <menu-list :value="getAccessors(prp[3])" :isfix="true"
              :sources="AccessInit.map(x => x[PLang])"
              @change:value="$event => changeAccessor(ii, $event)">
            </menu-list>

            <span @keypress="e => preventKeyPress(e, [13])"
              @input="e => onChange(e, 'access modify name', ii)"
              class="p36 ceditable" contenteditable="true" 
              data-placeholder="NameOfProperty"
              v-html="prp[1]"></span>
            <span v-if="getReturnType(prp[3])"><i>return</i>
              <span @input="e => onChange(e, 'access modify type', ii)"
                @keypress="e => preventKeyPress(e, [13, 32])"
                data-placeholder="ReturnTypeOfProperty"
                contenteditable="true" class="p36 ceditable" v-html="prp[2]"></span>
            </span>
            <span style="margin-left: 12px;cursor: pointer;"
              @click.stop="e => removeProperty(ii, false)"><i class="bi bi-trash3"></i></span>
          </div>
          <textarea v-if="getTxtType(EditObject.item.type) != 'interface'" class="objedit-vwcode"
            style="width: 100%; min-height: 90px;border-radius: 6px;border: none;"
            placeholder="ContentCodeOfProperty"
            @paste="pasteTxtArea" @keyup.enter="keyUpTxtArea" @keyup.delete="keyUpTxtArea"
            @change="e => onChange(e, 'code context', ii)">{{prp[4]}}</textarea>
        </div>
        <div v-if="EditObject.Propers">
          <div v-for="(prp, ii) in EditObject.Propers"
            style="margin-bottom: 2px;"
            :style="[0 == ii ? {marginTop: '10px'} : null]">
          <div style="display: flex;align-items: center;">
            <span class="p36 ceditable" @keypress="e => preventKeyPress(e, [13])"
              @blur="e => changeNewProp(e, 'access modify key', ii)"
              data-placeholder="AccessoriOfProperty"
              contenteditable="true">{{prp[0]}}</span>
            <menu-list :value="getAccessors(prp[3])" :isfix="true"
              :sources="AccessInit.map(x => x[PLang])"
              @change:value="$event => changeNewProp($event, 'acmtp', ii)">
            </menu-list>

            <span @keypress="e => preventKeyPress(e, [13])"
              @blur="e => changeNewProp(e, 'access modify name', ii)"
              class="p36 ceditable" contenteditable="true" 
              v-html="prp[1]"></span>
            <span v-if="getReturnType(prp[3])"><i>return</i>
              <span @blur="e => changeNewProp(e, 'access modify type', ii)"
                @keypress="e => preventKeyPress(e, [13, 32])"
                contenteditable="true" class="p36 ceditable" v-html="prp[2]"></span>
            </span>
            <span style="margin-left: 12px;cursor: pointer;"
              @click.stop="e => removeProperty(ii, false)"><i class="bi bi-trash3"></i></span>
          </div>
          <textarea v-if="getTxtType(EditObject.item.type) != 'interface'" class="objedit-vwcode"
            style="width: 100%; min-height: 90px;border-radius: 6px;border: none;"
            @paste="pasteTxtArea" @keyup.enter="keyUpTxtArea" @keyup.delete="keyUpTxtArea"
            @blur="e => changeNewProp(e, 'code context', ii)">{{prp[4]}}</textarea>
          </div>
        </div>
        <span style="cursor: pointer;"
        @click.stop="addProperty">[new Property]</span>
        <i style="width: 24px;height: 20px;display: inline-block;text-align: center;
          background-color: white;position: absolute;right: 35px;top: 5px;
          border-radius: 6px;padding-top: 4px;"
          class="bi bi-floppy cpoint" @click.stop="onSaveChange"></i>
        <i style="width: 24px;height: 20px;display: inline-block;text-align: center;
        background-color: white;position: absolute;right: 5px;top: 5px;border-radius: 6px;padding-top: 4px;"
        class="bi bi-x-lg cpoint" @click.stop="onCloseEdit"></i>
    </div>
    <div>
      Trace log: <span id="dnb-app-log"></span>
    </div>
  </main>

  <span class="dnb-imp-html" dnbpath="./components/vw-diagram.html"></span>

  <script type="module" src="m-app.js"></script>
</body>

</html>